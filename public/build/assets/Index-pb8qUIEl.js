import{r as d,j as e,L as Y}from"./app-JcAsAuql.js";import{A as q,U as z}from"./app-layout-E1jTg9LY.js";import{a as o}from"./ApiAdmin-CigcBv4Z.js";import{R as M}from"./refresh-cw-BJG4YFjv.js";import{P as H,S as X}from"./search-DCW9xceT.js";import{M as J}from"./mail-BvpHgBqQ.js";import{P as K}from"./phone-BvaIeQQR.js";import{S as Q}from"./square-pen-DJd9gEqa.js";import{U as V}from"./user-x-CXcl48Sg.js";import{U as W}from"./user-check-DK4LStuz.js";import{T as Z}from"./trash-2-yi-JkhIH.js";import"./button-f96-MP48.js";import"./index-CfwClSTy.js";import"./index-jL6B-qfF.js";import"./index-BwiEApH7.js";import"./index-Bm2cAylQ.js";import"./app-logo-icon-DBA5PkxD.js";import"./sweetalert2.esm.all-acGi8jXx.js";const f={name:"",email:"",phone:"",address:"",password:"",password_confirmation:"",status:"active",birthday:"",gender:"",emergency_contact_name:"",emergency_contact_phone:"",emergency_contact_relationship:"",insurance_provider:"",insurance_number:"",medical_history:"",allergies:"",current_medications:"",blood_type:""},U=[{value:"male",label:"Male"},{value:"female",label:"Female"},{value:"other",label:"Other"}],ee=["A+","A-","B+","B-","AB+","AB-","O+","O-"],re=[{title:"Dashboard",href:"/admin/dashboard"},{title:"Patient Records",href:"/admin/patients"}];function je(){const[j,v]=d.useState([]),[I,N]=d.useState(!0),[F,g]=d.useState(!1),[h,p]=d.useState(!1),[w,b]=d.useState(null),[s,t]=d.useState(f),[c,m]=d.useState({}),[i,_]=d.useState({search:"",status:"",gender:""}),u=async()=>{try{N(!0);const r=await o.getPatients(i);v(r.patients||r.data||[])}catch(r){console.error("Error fetching patients:",r);try{const a=await o.getUsers({...i,role:"patient"});v(a.data||a.users||[])}catch(a){console.error("Fallback error:",a)}}finally{N(!1)}};d.useEffect(()=>{u()},[i]);const R=async r=>{var a,l;r.preventDefault(),m({});try{if(h&&w)await o.updatePatient(w.id,s);else try{await o.createPatient(s)}catch{await o.createUser({...s,role:"patient"})}g(!1),t(f),b(null),p(!1),u()}catch(n){(l=(a=n.response)==null?void 0:a.data)!=null&&l.errors&&m(n.response.data.errors)}},B=async r=>{try{try{await o.deletePatient(r.id,r.name)}catch{await o.deleteUser(r.id,r.name)}u()}catch(a){console.error("Error deleting patient:",a)}},O=r=>{var a,l,n,x,C,k,P,E,S,A,D;b(r),t({name:r.name,email:r.email,phone:r.phone||"",address:r.address||"",password:"",password_confirmation:"",status:r.status||"active",birthday:((a=r.patient)==null?void 0:a.birthday)||"",gender:((l=r.patient)==null?void 0:l.gender)||"",emergency_contact_name:((n=r.patient)==null?void 0:n.emergency_contact_name)||"",emergency_contact_phone:((x=r.patient)==null?void 0:x.emergency_contact_phone)||"",emergency_contact_relationship:((C=r.patient)==null?void 0:C.emergency_contact_relationship)||"",insurance_provider:((k=r.patient)==null?void 0:k.insurance_provider)||"",insurance_number:((P=r.patient)==null?void 0:P.insurance_number)||"",medical_history:((E=r.patient)==null?void 0:E.medical_history)||"",allergies:((S=r.patient)==null?void 0:S.allergies)||"",current_medications:((A=r.patient)==null?void 0:A.current_medications)||"",blood_type:((D=r.patient)==null?void 0:D.blood_type)||""}),p(!0),g(!0),m({})},L=()=>{b(null),t(f),p(!1),g(!0),m({})},y=(r,a)=>{_(l=>({...l,[r]:a}))},T=()=>{_({search:"",status:"",gender:""})},$=async r=>{try{const a=r.status==="active"?"inactive":"active";try{await o.updatePatient(r.id,{status:a})}catch{await o.updateUser(r.id,{status:a})}u()}catch(a){console.error("Error toggling patient status:",a)}},G=r=>{if(!r)return null;const a=new Date,l=new Date(r);let n=a.getFullYear()-l.getFullYear();const x=a.getMonth()-l.getMonth();return(x<0||x===0&&a.getDate()<l.getDate())&&n--,n};return e.jsxs(q,{breadcrumbs:re,children:[e.jsx(Y,{title:"Patient Records Management"}),e.jsxs("div",{className:"flex flex-col gap-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Patient Records"}),e.jsx("p",{className:"text-gray-600",children:"Manage patient information and medical records"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:u,className:"flex items-center gap-2 px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50",children:[e.jsx(M,{className:"w-4 h-4"}),"Refresh"]}),e.jsxs("button",{onClick:L,className:"flex items-center gap-2 px-4 py-2 text-white bg-blue-600 rounded-lg hover:bg-blue-700",children:[e.jsx(H,{className:"w-4 h-4"}),"Add Patient"]})]})]}),e.jsx("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(X,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Search patients...",value:i.search,onChange:r=>y("search",r.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("select",{value:i.status,onChange:r=>y("status",r.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]}),e.jsxs("select",{value:i.gender,onChange:r=>y("gender",r.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Genders"}),U.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))]}),e.jsx("button",{onClick:T,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Clear"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Patient"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact Info"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Demographics"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:I?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-12 text-center text-gray-500",children:e.jsx("div",{className:"flex justify-center",children:e.jsx(M,{className:"w-6 h-6 animate-spin"})})})}):j.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-12 text-center text-gray-500",children:"No patients found"})}):j.map(r=>{var a,l,n;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx(z,{className:"h-5 w-5 text-blue-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:r.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",r.id]})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-900",children:[e.jsx(J,{className:"w-4 h-4 mr-2 text-gray-400"}),r.email]}),r.phone&&e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(K,{className:"w-4 h-4 mr-2 text-gray-400"}),r.phone]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"space-y-1",children:[((a=r.patient)==null?void 0:a.gender)&&e.jsx("div",{className:"text-sm text-gray-900",children:r.patient.gender.charAt(0).toUpperCase()+r.patient.gender.slice(1)}),((l=r.patient)==null?void 0:l.birthday)&&e.jsxs("div",{className:"text-sm text-gray-500",children:["Age: ",G(r.patient.birthday)]}),((n=r.patient)==null?void 0:n.blood_type)&&e.jsxs("div",{className:"text-sm text-gray-500",children:["Blood: ",r.patient.blood_type]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${r.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:r.status.charAt(0).toUpperCase()+r.status.slice(1)})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>O(r),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Edit",children:e.jsx(Q,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>$(r),className:`p-1 rounded ${r.status==="active"?"text-red-600 hover:bg-red-50":"text-green-600 hover:bg-green-50"}`,title:r.status==="active"?"Deactivate":"Activate",children:r.status==="active"?e.jsx(V,{className:"w-4 h-4"}):e.jsx(W,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>B(r),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete",children:e.jsx(Z,{className:"w-4 h-4"})})]})})]},r.id)})})]})})})]}),F&&e.jsx("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:h?"Edit Patient":"Add New Patient"}),e.jsxs("form",{onSubmit:R,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-md font-medium text-gray-900 mb-4",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name *"}),e.jsx("input",{type:"text",value:s.name,onChange:r=>t({...s,name:r.target.value}),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${c.name?"border-red-500":"border-gray-300"}`,placeholder:"Enter full name"}),c.name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:c.name[0]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address *"}),e.jsx("input",{type:"email",value:s.email,onChange:r=>t({...s,email:r.target.value}),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${c.email?"border-red-500":"border-gray-300"}`,placeholder:"Enter email address"}),c.email&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:c.email[0]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),e.jsx("input",{type:"tel",value:s.phone,onChange:r=>t({...s,phone:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter phone number"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),e.jsx("input",{type:"text",value:s.address,onChange:r=>t({...s,address:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter address"})]})]})]}),!h&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-md font-medium text-gray-900 mb-4",children:"Login Credentials"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password *"}),e.jsx("input",{type:"password",value:s.password,onChange:r=>t({...s,password:r.target.value}),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${c.password?"border-red-500":"border-gray-300"}`,placeholder:"Enter password"}),c.password&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:c.password[0]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password *"}),e.jsx("input",{type:"password",value:s.password_confirmation,onChange:r=>t({...s,password_confirmation:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Confirm password"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-md font-medium text-gray-900 mb-4",children:"Personal Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Birth"}),e.jsx("input",{type:"date",value:s.birthday,onChange:r=>t({...s,birthday:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gender"}),e.jsxs("select",{value:s.gender,onChange:r=>t({...s,gender:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select gender"}),U.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Blood Type"}),e.jsxs("select",{value:s.blood_type,onChange:r=>t({...s,blood_type:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select blood type"}),ee.map(r=>e.jsx("option",{value:r,children:r},r))]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-md font-medium text-gray-900 mb-4",children:"Emergency Contact"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Name"}),e.jsx("input",{type:"text",value:s.emergency_contact_name,onChange:r=>t({...s,emergency_contact_name:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter contact name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Phone"}),e.jsx("input",{type:"tel",value:s.emergency_contact_phone,onChange:r=>t({...s,emergency_contact_phone:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter contact phone"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Relationship"}),e.jsx("input",{type:"text",value:s.emergency_contact_relationship,onChange:r=>t({...s,emergency_contact_relationship:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Spouse, Parent"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-md font-medium text-gray-900 mb-4",children:"Insurance Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Insurance Provider"}),e.jsx("input",{type:"text",value:s.insurance_provider,onChange:r=>t({...s,insurance_provider:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter insurance provider"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Insurance Number"}),e.jsx("input",{type:"text",value:s.insurance_number,onChange:r=>t({...s,insurance_number:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter insurance number"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-md font-medium text-gray-900 mb-4",children:"Medical Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Medical History"}),e.jsx("textarea",{value:s.medical_history,onChange:r=>t({...s,medical_history:r.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter medical history"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Allergies"}),e.jsx("textarea",{value:s.allergies,onChange:r=>t({...s,allergies:r.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter known allergies"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Medications"}),e.jsx("textarea",{value:s.current_medications,onChange:r=>t({...s,current_medications:r.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter current medications"})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:()=>{g(!1),t(f),m({}),b(null),p(!1)},className:"flex-1 px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"flex-1 px-4 py-2 text-white bg-blue-600 rounded-lg hover:bg-blue-700",children:[h?"Update":"Create"," Patient"]})]})]})]})})})]})}export{je as default};
